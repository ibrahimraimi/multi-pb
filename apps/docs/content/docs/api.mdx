---
title: API Reference
description: Complete API documentation for Multi-PB
---

The internal API server runs on port 3001 inside the container but is exposed via Caddy at `/api`.

Base URL: `http://localhost:25983/api`

## Authorization

API authorization is **optional**. When an admin token is configured, **every** request (GET and write) must send it.

### Enabling Authorization

Set an admin token using either:

1. **Environment Variable**: `MULTIPB_ADMIN_TOKEN=your-secret-token`
2. **Config File**: Add `"adminToken": "your-secret-token"` to `/var/multipb/data/config.json`

When a token is set, all endpoints require `Authorization: Bearer <token>`.

### Examples

**List instances (GET):**
```bash
curl -s http://localhost:25983/api/instances \
  -H "Authorization: Bearer your-secret-token"
```

**Create instance (POST):**
```bash
curl -X POST http://localhost:25983/api/instances \
  -H "Authorization: Bearer your-secret-token" \
  -H "Content-Type: application/json" \
  -d '{"name": "myapp"}'
```

**Without token (when token is configured):**
```bash
curl -s http://localhost:25983/api/instances
# → 401 {"error":"Unauthorized","code":"admin_token_required"}
```

### Dashboard

If the API uses a token, open the dashboard → sidebar **Set token** → enter the same value. It is stored in `localStorage` and sent with every request. After a 401, the unlock modal appears so you can re-enter the token.

### Security Best Practices

- Use a strong, randomly generated token (e.g. `openssl rand -hex 24`)
- Prefer `MULTIPB_ADMIN_TOKEN` in the environment over `config.json`
- When no token is set, the API is open to anyone who can reach it—use network/firewall rules or set a token

## Instances

### List Instances

`GET /instances`
Returns a list of all configured instances.

### Create Instance

`POST /instances`

```json
{
  "name": "myapp",
  "email": "admin@example.com",
  "password": "secret",
  "memory": "512MB"
}
```

### Get Instance Details

`GET /instances/:name`
Returns details, status, backup list, and **health history**.

### Control Instance

`POST /instances/:name/start`
`POST /instances/:name/stop`
`POST /instances/:name/restart`

## Import

### Import from ZIP

`POST /import?name=new-name`
Body: Binary content of the ZIP file.

## Backups

### Create Backup

`POST /instances/:name/backups`

### Restore Backup

`POST /instances/:name/backups/:filename/restore`

### Download Backup

`GET /instances/:name/backups/:filename/download`

## Monitoring

### Health History

`GET /instances/:name/history`
Returns historical health check data.

### Notification Config

`GET /notifications/config`
Returns current public notification settings (e.g. configured webhook URL).

## System & Ports

### Check Port Availability

`GET /ports/check/:port`
Checks if a port is available and within the allowed range (30000-39999).

### List Used Ports

`GET /ports/used`
Returns a list of all ports currently assigned to instances.

### System Stats

`GET /stats`
Returns container CPU load, memory usage, and disk usage.
